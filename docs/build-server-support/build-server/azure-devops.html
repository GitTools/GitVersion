<!DOCTYPE html><html><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="description">
        <meta name="keywords" content="static content generator,static site generator,static site,HTML,web development,.NET,C#,Razor,Markdown,YAML">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon">
        <title>GitVersion - Azure DevOps or TFS Build Pipeline SetupUsage</title>
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/bootstrap/bootstrap.css" rel="stylesheet">
        <link href="/assets/css/adminlte/AdminLTE.css" rel="stylesheet">
        <link href="/assets/css/theme/theme.css" rel="stylesheet">
        <link href="//fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,400i,700,700i" rel="stylesheet">
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/assets/css/override.css" rel="stylesheet">
        <script src="/assets/js/jquery-2.2.3.min.js"></script>
        <script src="/assets/js/bootstrap.min.js"></script>        
        <script src="/assets/js/app.min.js"></script>         
        <script src="/assets/js/highlight.pack.js"></script>   
        <script src="/assets/js/jquery.slimscroll.min.js"></script>
        <script src="/assets/js/jquery.sticky-kit.min.js"></script>
        <script src="/assets/js/mermaid.min.js"></script>
        <script src="/assets/js/svg-pan-zoom.min.js"></script>
        <!--[if lt IE 9]>
        <script src="/assets/js/html5shiv.min.js"></script>
        <script src="/assets/js/respond.min.js"></script>
        <![endif]-->  

        <meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta name="google-site-verification" content="46g_yrsDyk5YTGoXb2ii9BjmTJ2QAEsacqn6wqiAiII">

    </head>
    <body class="hold-transition wyam layout-boxed  ">    
        <div class="top-banner"></div>
        <div class="wrapper with-container">
            <!-- Header -->
            <header class="main-header">   
                     
                <a href="/" class="logo">
                            <span>GitVersion</span>
                </a>   
                         
                <nav class="navbar navbar-static-top" role="navigation">
                    <!-- Sidebar toggle button-->
                        <a href="#" class="sidebar-toggle visible-xs-block" data-toggle="offcanvas" role="button">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-right"></i>
                        </a>
                                        
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-down"></i>
                        </button>
                    </div>
            
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">                            
                                    <li class="active"><a href="/docs">Docs</a></li>
        <li><a href="/api">API</a></li>
 
                        </ul>       
                    </div>
                    <!-- /.navbar-collapse -->
                
                    <!-- Navbar Right Menu -->
                </nav>
            </header>
            
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar ">
                <section class="infobar" data-spy="affix" data-offset-top="60" data-offset-bottom="200"> 
                    	
        <div><p><a href="https://github.com/gittools/GitVersion/tree/main/docs/input/docs/build-server-support/build-server/azure-devops.md"><i class="fa fa-pencil-square" aria-hidden="true"></i> Edit Content</a></p></div>
    <div id="infobar-headings"><h6>On This Page</h6><p><a href="#basic-usage">Basic Usage</a></p>
<p><a href="#executing-gitversion">Executing GitVersion</a></p>
<p><a href="#running-inside-tfs">Running inside TFS</a></p>
<hr class="infobar-hidden">
</div>

                </section>
                <section class="sidebar">    
                                     
                    

                    <ul class="sidebar-menu">
                        

                <li class="treeview">
                    <a href="/docs/usage">Getting Started</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/docs/usage/usage">Usage</a></li>
                <li><a href="/docs/usage/command-line">Command Line</a></li>
                <li><a href="/docs/usage/msbuild-task">MSBuild Task</a></li>
                <li><a href="/docs/usage/nuget-library">NuGet Library</a></li>

                    </ul>
                </li>
                <li><a href="/docs/configuration">Configuration</a></li>
                <li class="treeview active">
                    <a href="/docs/build-server-support">Build Server Support</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/docs/build-server-support/build-server-support">Introduction</a></li>
                <li class="treeview active">
                    <a href="/docs/build-server-support/build-server">Build Servers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/docs/build-server-support/build-server/appveyor">AppVeyor Setup</a></li>
                <li class="selected"><a href="/docs/build-server-support/build-server/azure-devops">Azure DevOps or TFS Build Pipeline SetupUsage</a></li>
                <li><a href="/docs/build-server-support/build-server/bamboo">Bamboo</a></li>
                <li><a href="/docs/build-server-support/build-server/continua">Continua CI Setup</a></li>
                <li><a href="/docs/build-server-support/build-server/gitlab">GitLab CI</a></li>
                <li><a href="/docs/build-server-support/build-server/jenkins">Jenkins Setup</a></li>
                <li><a href="/docs/build-server-support/build-server/myget">MyGet</a></li>
                <li><a href="/docs/build-server-support/build-server/octopus-deploy">Octopus Deploy</a></li>
                <li><a href="/docs/build-server-support/build-server/teamcity">TeamCity Setup</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li><a href="/docs/examples">Examples</a></li>
                <li><a href="/docs/faq">FAQ</a></li>
                <li><a href="/docs/why">Why use GitVersion?</a></li>
                <li><a href="/docs/who">Who is using GitVersion</a></li>
                <li class="treeview">
                    <a href="/docs/more-info">More Info</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/docs/more-info/how-it-works">How it works</a></li>
                <li><a href="/docs/more-info/dynamic-repositories">Dynamic Repositories</a></li>
                <li><a href="/docs/more-info/variables">Variables</a></li>
                <li><a href="/docs/more-info/version-increments">Version Incrementing</a></li>
                <li><a href="/docs/more-info/version-sources">Version Sources</a></li>
                <li><a href="/docs/more-info/incrementing-per-commit">Incrementing per commit</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/docs/git-branching-strategies">Git Branching Strategies</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/docs/git-branching-strategies/overview">Home</a></li>
                <li><a href="/docs/git-branching-strategies/gitflow">GitFlow</a></li>
                <li><a href="/docs/git-branching-strategies/githubflow">GitHubFlow</a></li>
                <li><a href="/docs/git-branching-strategies/gitflow-examples">GitFlow Examples</a></li>
                <li><a href="/docs/git-branching-strategies/githubflow-examples">GitHubFlow Examples</a></li>
                <li><a href="/docs/git-branching-strategies/converting-to-gitflow">Converting to GitFlow</a></li>
                <li><a href="/docs/git-branching-strategies/creating-updating-examples">Creating/Updating Examples</a></li>
                <li><a href="/docs/git-branching-strategies/gitflow-examples_complete">GitFlow Examples</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/docs/reference">Reference</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/docs/reference/intro-to-semver">Intro to SemVer</a></li>
                <li><a href="/docs/reference/git-setup">Git Setup</a></li>
                <li><a href="/docs/reference/feature-branches">Feature Branches</a></li>
                <li><a href="/docs/reference/pull-requests">Pull Requests</a></li>
                <li class="treeview">
                    <a href="/docs/reference/versioning-modes">Versioning Modes</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/docs/reference/versioning-modes/versioning-mode">Versioning Modes</a></li>
                <li><a href="/docs/reference/versioning-modes/continuous-delivery">Continuous Delivery</a></li>
                <li><a href="/docs/reference/versioning-modes/continuous-deployment">Continuous Deployment</a></li>
                <li><a href="/docs/reference/versioning-modes/mainline-development">Mainline Development</a></li>

                    </ul>
                </li>

                    </ul>
                </li>

                    </ul>
                            
                </section>                
            </aside>
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                



		<section class="content-header">
			<h1>Azure DevOps or TFS Build Pipeline SetupUsage</h1>
		</section>
	<section class="content">
		<h2 id="basic-usage">Basic Usage</h2>
<p>In Azure DevOps Pipeline (the web based build system) you can call GitVersion
either using the Command Line build step or install an extension / custom build
step. The custom build step requires a one-time setup to import the GitVersion
task into your TFS or Azure DevOps Pipeline instance.</p>
<h2 id="executing-gitversion">Executing GitVersion</h2>
<h3 id="using-gitversion-with-the-msbuild-task-nuget-package">Using GitVersion with the MSBuild Task NuGet Package</h3>
<ol>
<li>Add the <a href="https://www.nuget.org/packages/GitVersionTask/">GitVersionTask</a>
NuGet package to your projects.</li>
</ol>
<p>See <a href="../../usage/msbuild-task">MSBuild Task</a> for further instructions how to use the
MS Build Task.</p>
<h3 id="using-gitversion-with-the-command-line-build-step">Using GitVersion with the Command Line build step</h3>
<ol>
<li>Make sure to have GitVersion.exe under version control. There exists also a
<a href="https://chocolatey.org/packages/GitVersion.Portable">Chocolatey package</a> for
installing GitVersion.exe on build agents.</li>
<li>Add a Command Line build step to your build definition. You'll probably want
to drag the task to be at or near the top to ensure it executes before your
other build steps.</li>
<li>Set the Tool parameter to <code>&lt;pathToGitVersion&gt;\GitVersion.exe</code>.</li>
<li>Set the Arguments parameter to <code>/output buildserver /nofetch</code>.</li>
<li>If you want the GitVersionTask to update AssemblyInfo files add
<code>updateAssemblyInfo true</code> to the Arguments parameter.</li>
<li>If you want to update the build number you need to send a
<a href="https://github.com/Microsoft/azure-pipelines-tasks/blob/main/docs/authoring/commands.md">logging command</a>
to TFS.</li>
</ol>
<h3 id="using-the-custom-gitversion-build-step">Using the custom GitVersion build step</h3>
<h4 id="installing">Installing</h4>
<h5 id="installing-the-extension">Installing the extension</h5>
<p>For Visual Studio Team Service or TFS 2015 Update 2 or higher it is recommended
to install the GitVersion extension:</p>
<ol>
<li>Install the
<a href="https://marketplace.visualstudio.com/items?itemName=gittools.usegitversion">GitVersion Extension</a>.</li>
</ol>
<h5 id="manually-installingupdating-the-custom-build-step">Manually installing/updating the custom build step</h5>
<p>If you run TFS 2015 RTM or Update 1 or don't want to install the GitVersion
extension you can install the build task manually:</p>
<ol>
<li>Install the <code>tfx</code> command line tool as shown <a href="https://github.com/Microsoft/tfs-cli/blob/main/README.md#install">here</a>.</li>
<li>For TFS 2015 On-Prem configure Basic Authentication in TFS as shown <a href="https://github.com/Microsoft/tfs-cli/blob/main/docs/configureBasicAuth.md">here</a>.</li>
<li>Download the GitVersion TFS build task from the latest release on the
<a href="https://github.com/GitTools/GitVersion/releases">GitVersion releases page</a> and
unzip.</li>
<li>Run <code>tfx login</code> as shown <a href="https://github.com/Microsoft/tfs-cli/blob/main/README.md#login">here</a>.</li>
<li>From the directory outside of where you unzipped the task, run
<code>tfx build tasks upload --task-path .\GitVersionVsixTask --overwrite</code> where
GitVersionVsixTask is the directory containing the files.</li>
<li>It should successfully install.</li>
</ol>
<h4 id="using-the-gitversion-custom-build-step">Using the GitVersion custom build step</h4>
<p>From a TFS build definition, select "Add a Step" and then in the Build category,
choose GitVersion and click Add. You'll probably want to drag the task to be at
or near the top to ensure it executes before your other build steps.</p>
<p>If you want the GitVersionTask to update AssemblyInfo files, check the box in
the task configuration. For advanced usage, you can pass additional options to
the GitVersion exe in the Additional arguments section.</p>
<p>The Azure DevOps Pipeline build step can update your build number with
GitVersion variables. See below for details.</p>
<h4 id="using-pipelines-yaml">Using Pipelines yaml</h4>
<p>Add the following yaml task and variable to your <code>azure-pipelines.yml</code> file:</p>
<pre><code class="language-yml">variables:
  GitVersion.SemVer: ''

steps:
- task: UseGitVersion@5
  displayName: gitversion
  inputs:
    versionSpec: '5.x'
    updateAssemblyInfo: true
</code></pre>
<p>You can now use the <code>GitVersion.SemVer</code> environment variable in any subsequent
tasks to refer to the semantic version number for your build. For example, you
can build your dotnet core application with a semantic version number like so:</p>
<pre><code class="language-yml">- task: DotNetCoreCLI@2
  displayName: Build
  inputs:
    command: build
    projects: '$(solution)'
    configuration: '$(buildConfiguration)'
    versioningScheme: byEnvVar
    versionEnvVar: 'GitVersion.SemVer'

</code></pre>
<h2 id="running-inside-tfs">Running inside TFS</h2>
<h3 id="using-the-gitversion-variables">Using the GitVersion Variables</h3>
<p>GitVersion passes variables in the form of <code>GitVersion.*</code> (Eg:
<code>GitVersion.Major</code>) to TFS Build and also writes <code>GITVERSION.*</code>
(Eg: <code>GITVERSION.MAJOR</code>) environment variables that are available for any
subsequent build step.</p>
<p>To use these variables you can just refer to them using the standard variable
syntax. For instance <code>$(GitVersion.NuGetVersion)</code> in your nuget pack task to set
the version number. Since update 1 there are no known limitations.</p>
<p>See <a href="../../more-info/variables">Variables</a> for an overview of available variables.</p>
<h4 id="using-gitversion-variables-in-build-name">Using GitVersion variables in build name</h4>
<p>To use GitVersion's variables in the build name, just add them in the form
<code>$(GITVERSION_FullSemVer)</code> into the Build definition's build number string. Then
just ensure GitVersion is called with <code>/output buildserver</code> and it will replace
those variables with the calculated version.  The TFS GitVersion Build Step
(above) handles this too, so if you're already using that, there's nothing extra
to configure.</p>
<p>If GitVersion does not find any substitutions it will just default to using <code>FullSemVer</code></p>
<div class="alert alert-danger"><p><strong>Important</strong></p>
<p>If you currently use <code>$(rev:.r)</code> in your build number, that won't
work correctly if you
use GitVersion variables as well due to the delayed expansion of the GitVersion
vars. Instead, you might be able to use <code>$(GitVersion_BuildMetaData)</code> to achieve
a similar result.  See <a href="../../more-info/variables">Variables</a> for more info on the
variables.</p>
</div>
<h4 id="known-limitations">Known limitations</h4>
<ul>
<li>If you are using on premises TFS, make sure you are using at least
<strong>TFS 2015 Update 1</strong>, otherwise a few things will not work.</li>
<li>Installing the extension on an on premise TFS requires at least TFS 2015
Update 2.</li>
<li>You need to make sure that all tags are fetched for the Git repository,
otherwise you may end with wrong versions (e.g. <code>FullSemVer</code> like <code>1.2.0+5</code>
instead of <code>1.2.0</code> for tagged releases)  Just checking the <code>Clean Repository</code>
check box in the build definition settings might not be enough since this will
run a <code>git clean -fdx/reset --hard</code> without fetching all tags later. You can
force deletion of the whole folder and a re-clone containing all tags by
settings the variable <code>Build.Clean</code> to <code>all</code>. This will take more time during
build but makes sure that all tags are fetched. In the future it is planned to
allow using <code>git.exe</code> instead of current <code>libgit2sharp</code> for syncing the repos
which might allow other possibilities to solve this issue. For details see this
<a href="https://github.com/Microsoft/azure-pipelines-tasks/issues/1218">GitHub issue</a>.</li>
<li>If running a build for a certain commit (through passing the commit SHA while
queueing the build) all tags from the repository will be fetched, even the ones
newer than the commit.  This can lead to different version numbers while
re-running historical builds.</li>
</ul>

	</section>
                
            </div>           
            
            <!-- Footer -->
            <footer class="main-footer">
            </footer>
            
        </div>
        <div class="wrapper bottom-wrapper">
            <footer class="bottom-footer">
                Generated by <a href="https://wyam.io">Wyam</a>
            </footer>
        </div>
        <a href="javascript:" id="return-to-top"><i class="fa fa-chevron-up"></i></a>
        <div class="github-button">
    <a href="https://github.com/GitTools/GitVersion"><i class="fa fa-github"></i> GitHub</a>
</div>
<script>
    ((window.gitter = {}).chat = {}).options = {
        room: 'GitTools/GitVersion'
    };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script>

        <script>           
            // Close the sidebar if we select an anchor link
            $(".main-sidebar a[href^='#']:not('.expand')").click(function(){
                $(document.body).removeClass('sidebar-open');
            });
            
            $(document).ready(function() {
                mermaid.initialize(
                {
                    flowchart:
                    {
                        useMaxWidth: false
                    },
					startOnLoad: false,
					cloneCssStyles: false
                });     
                mermaid.init(undefined, ".mermaid");

                // Remove the max-width setting that Mermaid sets
                var mermaidSvg = $('.mermaid svg');
                mermaidSvg.addClass('img-responsive');
                mermaidSvg.css('max-width', '');

                // Make it scrollable
				var target = document.querySelector(".mermaid svg");
				if(target !== null)
				{
					var panZoom = window.panZoom = svgPanZoom(target, {
						zoomEnabled: true,
						controlIconsEnabled: true,
						fit: true,
						center: true,
                        maxZoom: 20,
                        zoomScaleSensitivity: 0.6
					});			                          

                    // Do the reset once right away to fit the diagram
                    panZoom.resize();
                    panZoom.fit();
                    panZoom.center();
                    
                    $(window).resize(function(){
                        panZoom.resize();
                        panZoom.fit();
                        panZoom.center();
                    });
				}
                
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });  
            });

            hljs.initHighlightingOnLoad();

            // Back to top
            $(window).scroll(function() {
                if ($(this).scrollTop() >= 200) {        // If page is scrolled more than 50px
                    $('#return-to-top').fadeIn(1000);    // Fade in the arrow
                } else {
                    $('#return-to-top').fadeOut(1000);   // Else fade out the arrow
                }
            });
            $('#return-to-top').click(function() {      // When arrow is clicked
                $('body,html').animate({
                    scrollTop : 0                       // Scroll to top of body
                }, 500);
            });
        </script>
    
</body></html>